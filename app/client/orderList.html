<template name="orderList">
	<div class="uk-container uk-margin-top">

		<div class="uk-flex">
			<div class="uk-width-1-2">
				<h2>Order Review and Selection - {{date}} </h2>
			</div>
			<div class="uk-width-1-2">
				{{>actionBar}}
			</div>
		</div>

<div id="ship-modal" uk-modal>
	<div class="uk-modal-dialog uk-modal-body">
		<button class="uk-modal-close-default" type="button" uk-close></button>
		<h2 class="uk-modal-title">Ship Selected Orders</h2>
		<p>
			This will request Rocketspark to update each order as Shipped and send a confirmation email to each customer.
		</p>
		<p>
			{{>jobSpinner jobtype="ship order"}}
		</p>
		<p>
			Are you sure you want ship selected orders?
		</p>
		<p class="uk-text-right">
			<button class="uk-button uk-button-default uk-modal-close" type="button">Cancel</button>
			<a class="uk-button uk-button-primary uk-modal-close" onclick="Meteor.call('ship selected')">Ship</a>
		</p>
	</div>
</div>

		<table class="uk-table uk-table-middle uk-table-hover uk-table-small uk-text-small uk-table-divider">
			<thead>
				<tr>
					<th class="uk-table-shrink">

						<a class="uk-icon-button" href=""><i class="fas fa-bars"></i></a>
						<div uk-dropdown>
						    <ul class="uk-nav uk-dropdown-nav">
						        <li><a href="#" class="js-clear-all">Clear All Selections</a></li>
						        <li><a href="#" class="js-select-todays">Select Todays Deliveries</a></li>
						        <li><a href="#" class="js-select-all">Select All Orders</a></li>
						        <li class="uk-nav-divider"></li>
						        <li><a href="#ship-modal" class="js-toggle-ship-modal">Ship Selected Orders</a></li>
						    </ul>
						</div>

					</th>
					<th>Ref / Price</th>
					<th>Expected Delivery</th>
					<th>Sender &amp; Delivery Phone</th>
					<th class="uk-width-1-5">Delivery Name & Address</th>
					<th>
						<span class="uk-align-right uk-margin-remove-bottom">
							{{numItems}} Orders
							{{>pagination numPages}}
						</span>
						<span><br>Greeting Card Message</span>
					</th>
				</tr>
			</thead>
			<tbody>
				{{#each order in orders}}
					<tr class="{{isShippedFormat order}}">
						<td class="uk-text-center">
							<input type="checkbox" {{isSelectedChk order}} class="uk-checkbox js-toggleOrderIsSelected" data-order-no="{{order.orderNo}}">
						</td>
					    <td class="uk-text-nowrap">
							<b class="js-orderDetail" data-order-no="{{order.orderNo}}">{{order.orderNo}}{{order.productCode}}</b><br>
						    ${{order.amount}}<br>
						</td>
						<td>
							<b>{{isSelectedMessage order}}</b>
							{{order.deliveryDate}}<br>
							{{isShippedMessage order}}
							<span class="js-orderDetail" data-order-no="{{order.orderNo}}" uk-tooltip title="Click this field to reset the delivery address and message back to the original">{{isModifiedMessage order}}</span>
						</td>
						<td>
							{{order.customerName}}<br>
							{{order.customerEmail}}<br>
							{{order.customerPhone}}
						</td>
						<td class="js-shipAddress" data-order-no="{{order.orderNo}}" uk-tooltip title="{{order.shipLocation.geoAddr}} {{order.shipLocation.partial}}">
							<div>
								{{#unless order.shipLocation}}
									<div><i class="uk-align-right uk-alert-danger fas fa-question-circle"></i></div>
								{{/unless}}
								{{#if order.shipLocation.partial}}
									<div><i class="uk-align-right uk-alert-success fas fa-question-circle"></i></div>
								{{/if}}
								{{#each line in order.shipAddress}}
									{{line}}<br>
								{{/each}}
							</div>
						</td>
						<td class="js-specialMessage" data-order-no="{{order.orderNo}}">
							<div>
								A Posy For: {{order.deliveryTo}}<br>
								{{order.specialMessage}}<br>
								From: {{order.deliveryFrom}}<br>
							</div>
						</td>
					</tr>
				{{/each}}
			</tbody>
		</table>
		<div class="uk-section">
			<a href="" uk-scroll class="uk-totop">Top</a>
			{{>pagination numPages}}
		</div>

	</div>
</template>

